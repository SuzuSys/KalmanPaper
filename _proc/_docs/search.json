[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "KalmanPaper",
    "section": "",
    "text": "This file will become your README and also the index of your documentation.",
    "crumbs": [
      "KalmanPaper"
    ]
  },
  {
    "objectID": "index.html#developer-guide",
    "href": "index.html#developer-guide",
    "title": "KalmanPaper",
    "section": "Developer Guide",
    "text": "Developer Guide\nIf you are new to using nbdev here are some useful pointers to get you started.\n\nInstall KalmanPaper in Development mode\n# make sure KalmanPaper package is installed in development mode\n$ pip install -e .\n\n# make changes under nbs/ directory\n# ...\n\n# compile to have changes apply to KalmanPaper\n$ nbdev_prepare",
    "crumbs": [
      "KalmanPaper"
    ]
  },
  {
    "objectID": "index.html#usage",
    "href": "index.html#usage",
    "title": "KalmanPaper",
    "section": "Usage",
    "text": "Usage\n\nInstallation\nInstall latest from the GitHub repository:\n$ pip install git+https://github.com/SuzuSys/KalmanPaper.git\nor from conda\n$ conda install -c SuzuSys KalmanPaper\nor from pypi\n$ pip install KalmanPaper\n\n\nDocumentation\nDocumentation can be found hosted on this GitHub repository’s pages. Additionally you can find package manager specific guidelines on conda and pypi respectively.",
    "crumbs": [
      "KalmanPaper"
    ]
  },
  {
    "objectID": "common.html",
    "href": "common.html",
    "title": "共通概念・表記",
    "section": "",
    "text": "\\[\n\\begin{split}\np(y_t=1\\mid\\mathbf w_t) &= \\sigma(\\mathbf w_t^T\\mathbf x_t) \\\\\np(\\mathbf w_{t+1}\\mid\\mathbf w_t) &= \\mathcal N(\\mathbf w_{t+1}\\mid\\mathbf w_t,\\mathbf \\Gamma)\n\\end{split}\n\\]\n\\[\n\\begin{split}\np(\\mathbf w_t\\mid\\mathbf Y_t) &= \\mathcal N(\\mathbf w_t\\mid\\hat{\\mathbf w}_{t/t},\\mathbf P_{t/t}) \\\\\np(\\mathbf w_{t+1}\\mid\\mathbf Y_t) &= \\mathcal N(\\mathbf w_{t+1}\\mid\\hat{\\mathbf w}_{t+1/t},\\mathbf P_{t+1/t})\n\\end{split}\n\\]",
    "crumbs": [
      "共通概念・表記"
    ]
  },
  {
    "objectID": "common.html#logistic-sigmoid-func.-と-softmax-func.",
    "href": "common.html#logistic-sigmoid-func.-と-softmax-func.",
    "title": "共通概念・表記",
    "section": "Logistic sigmoid func. と Softmax func.",
    "text": "Logistic sigmoid func. と Softmax func.\nクラスの条件付き確率密度がガウス分布であると仮定する。このとき、共分散行列が各クラスに共有されるとする。\n\\[p(\\mathbf x_t\\mid y_t=\\mathcal C_1)=\\mathcal N(\\mathbf x_t\\mid\\boldsymbol \\mu_{\\mathcal C_1},\\boldsymbol\\Sigma)\\]\nこのとき、決定境界は \\(\\mathbf x_t\\) に対して線形となる。\n共分散行列が各クラスに共有されないとすると、決定境界は２次判別関数となる \\(\\mathbf x_t\\) の２次関数を得る。",
    "crumbs": [
      "共通概念・表記"
    ]
  },
  {
    "objectID": "template.html",
    "href": "template.html",
    "title": "Template",
    "section": "",
    "text": "source\n\nfoo\n\n foo (a, b=2)\n\n\n\n\n\nType\nDefault\nDetails\n\n\n\n\na\n\n\n\\(a\\)\n\n\nb\nint\n2\n\\(b\\)\n\n\nReturns\nint\n\n\\(c\\)",
    "crumbs": [
      "Template"
    ]
  },
  {
    "objectID": "funcs.html",
    "href": "funcs.html",
    "title": "簡単な関数等",
    "section": "",
    "text": "\\[\\sigma(x)=\\frac{1}{1+e^{-x}}\\]\n\nsource\n\n\n\n losi (x:NDArray[Shape['*,*'],Float])\n\n\n\n\n\nType\nDetails\n\n\n\n\nx\nNDArray\n\\(x\\)\n\n\nReturns\nNDArray\n\\(\\sigma(x)=1/(1+ e\\\\^{-x})\\)",
    "crumbs": [
      "簡単な関数等"
    ]
  },
  {
    "objectID": "funcs.html#logistic-sigmoid",
    "href": "funcs.html#logistic-sigmoid",
    "title": "簡単な関数等",
    "section": "",
    "text": "\\[\\sigma(x)=\\frac{1}{1+e^{-x}}\\]\n\nsource\n\n\n\n losi (x:NDArray[Shape['*,*'],Float])\n\n\n\n\n\nType\nDetails\n\n\n\n\nx\nNDArray\n\\(x\\)\n\n\nReturns\nNDArray\n\\(\\sigma(x)=1/(1+ e\\\\^{-x})\\)",
    "crumbs": [
      "簡単な関数等"
    ]
  },
  {
    "objectID": "funcs.html#lambda-function",
    "href": "funcs.html#lambda-function",
    "title": "簡単な関数等",
    "section": "Lambda Function",
    "text": "Lambda Function\n\\[\\lambda(x)=\\frac{1}{2x}\\left[\\sigma(x)-\\frac{1}{2}\\right]\\]\n\nsource\n\nlam\n\n lam (x:NDArray[Shape['*,*'],Float])\n\n\n\n\n\nType\nDetails\n\n\n\n\nx\nNDArray\n\\(x\\)\n\n\nReturns\nNDArray\n\\(\\lambda(x)\\)",
    "crumbs": [
      "簡単な関数等"
    ]
  },
  {
    "objectID": "EKF/ekf.html",
    "href": "EKF/ekf.html",
    "title": "Extended Kalman Filter",
    "section": "",
    "text": "区分行列 \\(\\mathbf M\\) を\n\\[\\mathbf M=\\begin{pmatrix}\\mathbf A & \\mathbf B \\\\ \\mathbf C & \\mathbf D  \\end{pmatrix}\\]\nとしたとき、区画 \\(\\mathbf D\\) に関する Schur 補行列とは\n\\[\\mathbf M/\\mathbf D=\\mathbf A-\\mathbf B\\mathbf D^{-1}\\mathbf C\\]\nで与えられる。\n定理\n対称な行列 \\(\\mathbf M\\) を\n\\[\\mathbf M=\\begin{pmatrix}\\mathbf A & \\mathbf B \\\\ \\mathbf B^T & \\mathbf C\\end{pmatrix}\\]\nとすると、 \\(\\mathbf A\\succ 0\\) であるとき、\n\\[\\text{If}\\ \\mathbf C\\succ 0, \\text{then}\\ (\\mathbf M\\succ 0\\iff \\mathbf M/\\mathbf C\\succeq 0)\\]\nが成り立つ。\n定理\n\\(\\mathbb E\\) を任意の期待値： \\(\\mathbb E_{\\mathbf x,\\mathbf y}, \\mathbb E_{\\mathbf x\\mid\\mathbf y}, \\mathbb E_{\\mathbf y\\mid\\mathbf x}\\) であるとする。\n\\[\n\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\succeq 0\n\\]\n証明\n\\(\\mathbf h(\\mathbf x,\\mathbf y)\\) を\n\\[\\mathbf h(\\mathbf x,\\mathbf y)=\\begin{pmatrix}\\mathbf f(\\mathbf x,\\mathbf y) \\\\ \\mathbf g(\\mathbf x,\\mathbf y)\\end{pmatrix}\\]\nとすると、任意のベクトル \\(\\mathbf u\\) に対して\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbf u^T\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\mathbf u \\\\\n&= \\mathbf u^T\\mathbb E[\\mathbf h(\\mathbf x,\\mathbf y)\\mathbf h(\\mathbf x,\\mathbf y)^T]\\mathbf u \\\\\n&= \\mathbb E[(\\mathbf h(\\mathbf x,\\mathbf y)\\mathbf u)^2] \\\\\n&\\succeq 0\n\\end{split}\n\\]\n定理\n\\(\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\succ 0\\) のとき、\n\\[\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T]\\succeq\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^{-1}\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T\\]\nが成り立つ。\n証明\n\\[\\mathbf M=\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\]\nとすると、 \\(\\mathbf M\\succeq 0\\) であり、よって \\(\\mathbf M/\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\succeq 0\\) である。\n\n\n\n\\(\\mathbf w\\) を未知変数、 \\(y\\) を観測変数とする。 Fisher 情報行列を\n\\[\n\\begin{split}\nI(\\mathbf w) &=-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] \\\\\n&= -\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&\\in\\mathbb R^{n\\times n}\n\\end{split}\n\\]\nとする。各要素は\n\\[\nI_{ij}=-\\mathbb E_{y\\mid\\mathbf w}\\left[\\frac{\\partial^2}{\\partial w_i\\partial w_j}\\ln p(y\\mid\\mathbf w)\\right]\n\\]\nとなる。\n\n\n\n\\[\n\\begin{split}\nI(\\mathbf w) &=-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] \\\\\n&= -\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&= -\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\left[\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]\\right)p(y\\mid\\mathbf w)dy \\\\\n&= -\\int\\left(-\\left[\\frac{1}{p(y\\mid\\mathbf w)}\\right]^2\\left[\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]\\left[\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]^T+\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial^2}{\\partial\\mathbf w^2}p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&= \\int\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial \\mathbf w}p(y\\mid\\mathbf w)\\right)\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial \\mathbf w}p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy-\\int\\frac{\\partial^2}{\\partial\\mathbf w^2}p(y\\mid\\mathbf w)dy \\\\\n&= \\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy-\\underbrace{\\frac{\\partial^2}{\\partial\\mathbf w^2}\\int p(y\\mid\\mathbf w)dy}_\\mathbf O \\\\\n&= \\mathbb E_{y\\mid\\mathbf w}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]\n\\end{split}\n\\]\nであるから、Fisher 情報行列は\n\\[\nI(\\mathbf w) =-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] = \\mathbb E_{y\\mid\\mathbf w}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]\n\\]\nと表せる。\n\n\n\n定理\n\\(I(\\mathbf w)\\succ 0\\) のとき、\n\\[\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right]\\succeq I^{-1}(\\mathbf w)\\]\nが成り立つ。ただし、 \\(\\mathbf f(y)\\) は不偏推定値とする。つまり、次式が成り立つとする。\n\\[\\mathbb E_{y\\mid\\mathbf w}[\\mathbf f(y)]=\\mathbf w\\]\n証明\nSchur 補行列の正定値性より、\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right] \\\\\n&\\succeq \\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]I^{-1}(\\mathbf w)\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]^T\n\\end{split}\n\\]\nここで、\n\\[\n\\begin{split}\n\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right] &= \\int\\left(\\mathbf w-\\mathbf f(y)\\right)\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy \\\\\n&= \\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right)^Tdy \\\\\n&= \\mathbf w\\left( \\frac{\\partial}{\\partial \\mathbf w} \\int p(y\\mid\\mathbf w) dy \\right)^T-\\frac{\\partial}{\\partial \\mathbf w^T}\\int \\mathbf f(y) p(y\\mid\\mathbf w)dy \\\\\n&= \\underbrace{\\mathbf w\\left(\\frac{\\partial}{\\partial \\mathbf w} 1\\right)^T}_\\mathbf O-\\frac{\\partial}{\\partial\\mathbf w^T}\\mathbf w \\\\\n&= -\\mathbf I\n\\end{split}\n\\]\nが成り立つ。 \\(\\mathbf I\\) は単位行列を表す。\n\n\n\n\\(\\mathbf w\\) を未知変数、 \\(y\\) を観測変数とする。 ベイズ情報行列を\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w, y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w, y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w, y)\\right)p(\\mathbf w, y)dyd\\mathbf w \\\\\n&\\in\\mathbb R^{n\\times n}\n\\end{split}\n\\]\nとする。各要素は\n\\[\nJ_{ij}=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial w_i\\partial w_j}\\ln p(\\mathbf w,y)\\right]\n\\]\nとなる。\n\n\n\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= -\\int\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\left[\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= -\\int\\int\\left(-\\left[\\frac{1}{p(\\mathbf w,y)}\\right]^2\\left[\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]\\left[\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]^T+\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial^2}{\\partial\\mathbf w^2}p(\\mathbf w,y)\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial \\mathbf w}p(\\mathbf w,y)\\right)\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial \\mathbf w}p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy-\\int\\int\\frac{\\partial^2}{\\partial\\mathbf w^2}p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy-\\underbrace{\\frac{\\partial^2}{\\partial\\mathbf w^2}\\int\\int p(\\mathbf w,y)d\\mathbf wdy}_\\mathbf O \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]\n\\end{split}\n\\]\nであり、\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w\\mid y)\\right)p(\\mathbf w,y)d\\mathbf wdy -\\underbrace{\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y)\\right)p(\\mathbf w,y)d\\mathbf wdy}_\\mathbf O \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)^T\\right]\n\\end{split}\n\\]\nであるから、ベイズ情報行列は\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right] \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)^T\\right]\n\\end{split}\n\\]\nと表せる。\n\n\n\n定理\n\\(J\\succ 0\\) のとき、\n\\[\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right]\\succeq J^{-1}\\]\nが成り立つ。ただし、次式が成り立つとする。\n\\[\\lim_{\\mathbf w_i\\to\\pm\\infty}\\mathbb E_{y\\mid\\mathbf w}[\\mathbf f(y)-\\mathbf w]p(\\mathbf w)=\\lim_{\\mathbf w_i\\to\\pm\\infty}\\int (\\mathbf f(y)-\\mathbf w)p(\\mathbf w,y)dy=\\mathbf 0,\\ i=1,\\ldots,n\\]\n証明\nSchur 補行列の正定値性より、\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right] \\\\\n&\\succeq \\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]J^{-1}\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]^T\n\\end{split}\n\\]\nここで、\n\\[\n\\begin{split}\n\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right] &= \\int\\int\\left(\\mathbf w-\\mathbf f(y)\\right)\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Td\\mathbf wdy\n\\end{split}\n\\]\nが成り立つ。\\(ij\\) 要素に対して置換積分すると、\n\\[\n\\begin{split}\n& \\left\\{\\int\\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Td\\mathbf wdy\\right\\}_{ij} \\\\\n&= \\int\\int(w_i-f_i(y))\\left(\\frac{\\partial}{\\partial w_j}p(\\mathbf w,y)\\right)d\\mathbf wdy \\\\\n&= \\int\\int\\left[(w_i-f_i(y))p(\\mathbf w,y)\\right]_{w_j=-\\infty}^{w_j=\\infty}d\\mathbf w_kdy-\\int\\int\\frac{\\partial}{\\partial w_j}(w_i-f_i(y))p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\left[\\lim_{w_j\\to\\infty}\\int(w_i-f_i(y))p(\\mathbf w,y)dy-\\lim_{w_j\\to-\\infty}\\int(w_i-f_i(y))p(\\mathbf w,y)dy\\right]d\\mathbf w_k - I_{ij} \\\\\n&= -I_{ij}\n\\end{split}\n\\]\nとなる。\\(\\mathbf w_k\\) は \\(k\\neq j\\) となる全ての \\(k\\) を添字とする \\(w\\) を表す。 \\(I_{ij}\\) とは単位行列 \\(\\mathbf I\\) の \\(ij\\) 要素を表す。\n\\[\\frac{d}{dx}\\sigma(x)=\\sigma(x)\\{1-\\sigma(x)\\}\\]\n\nsource\n\n\n\n\n dxlosi (x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nx\nndarray\n\\(x\\)\n\n\nReturns\nndarray\n\\(\\lambda(x)\\)\n\n\n\n\\[\\sigma_t=\\sigma(\\hat{\\mathbf w}_{t/t-1}^T\\mathbf x_t)\\] \\[\\mathbf P_{t/t}=\\mathbf P_{t/t-1}-\\frac{\\sigma_t(1-\\sigma_t)}{1+\\sigma_t(1-\\sigma_t)\\mathbf x_t^T\\mathbf P_{t/t-1}\\mathbf x_t}(\\mathbf P_{t/t-1}\\mathbf x_t)(\\mathbf P_{t/t-1}\\mathbf x_t)^T\\]\n\nsource\n\n\n\n\n Ptt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\n\n\\[\\hat{\\mathbf w}_{t/t}=\\hat{\\mathbf w}_{t/t-1}+\\frac{1}{1+\\sigma_t(1-\\sigma_t)\\mathbf x_t^T\\mathbf P_{t/t-1}\\mathbf x_t}\\mathbf P_{t/t-1}\\mathbf x_t(y_t-\\sigma_t)\\]\n\nsource\n\n\n\n\n wtt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\ny\nndarray\n\\(y_t\\)\n\n\n\n\\[N,T,\\{ \\mathbf x_t \\}_{t=0,\\ldots,T-1}, \\{ y_t \\}_{t=0,\\ldots,T-1}, \\boldsymbol\\Gamma, \\hat{\\mathbf w}_{0/-1}, \\mathbf P_{0/-1} \\\\\n\\to\\{\\hat{\\mathbf w}_{t/t}\\}_{t=0,\\ldots,T-1},\\{\\mathbf P_{t/t}\\}_{t=0,\\ldots,T-1}\\]\n\nsource\n\n\n\n\n EKF (N:int, T:int,\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      G:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      P0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])",
    "crumbs": [
      "EKF",
      "Extended Kalman Filter"
    ]
  },
  {
    "objectID": "EKF/ekf.html#概要",
    "href": "EKF/ekf.html#概要",
    "title": "Extended Kalman Filter",
    "section": "",
    "text": "区分行列 \\(\\mathbf M\\) を\n\\[\\mathbf M=\\begin{pmatrix}\\mathbf A & \\mathbf B \\\\ \\mathbf C & \\mathbf D  \\end{pmatrix}\\]\nとしたとき、区画 \\(\\mathbf D\\) に関する Schur 補行列とは\n\\[\\mathbf M/\\mathbf D=\\mathbf A-\\mathbf B\\mathbf D^{-1}\\mathbf C\\]\nで与えられる。\n定理\n対称な行列 \\(\\mathbf M\\) を\n\\[\\mathbf M=\\begin{pmatrix}\\mathbf A & \\mathbf B \\\\ \\mathbf B^T & \\mathbf C\\end{pmatrix}\\]\nとすると、 \\(\\mathbf A\\succ 0\\) であるとき、\n\\[\\text{If}\\ \\mathbf C\\succ 0, \\text{then}\\ (\\mathbf M\\succ 0\\iff \\mathbf M/\\mathbf C\\succeq 0)\\]\nが成り立つ。\n定理\n\\(\\mathbb E\\) を任意の期待値： \\(\\mathbb E_{\\mathbf x,\\mathbf y}, \\mathbb E_{\\mathbf x\\mid\\mathbf y}, \\mathbb E_{\\mathbf y\\mid\\mathbf x}\\) であるとする。\n\\[\n\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\succeq 0\n\\]\n証明\n\\(\\mathbf h(\\mathbf x,\\mathbf y)\\) を\n\\[\\mathbf h(\\mathbf x,\\mathbf y)=\\begin{pmatrix}\\mathbf f(\\mathbf x,\\mathbf y) \\\\ \\mathbf g(\\mathbf x,\\mathbf y)\\end{pmatrix}\\]\nとすると、任意のベクトル \\(\\mathbf u\\) に対して\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbf u^T\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\mathbf u \\\\\n&= \\mathbf u^T\\mathbb E[\\mathbf h(\\mathbf x,\\mathbf y)\\mathbf h(\\mathbf x,\\mathbf y)^T]\\mathbf u \\\\\n&= \\mathbb E[(\\mathbf h(\\mathbf x,\\mathbf y)\\mathbf u)^2] \\\\\n&\\succeq 0\n\\end{split}\n\\]\n定理\n\\(\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\succ 0\\) のとき、\n\\[\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T]\\succeq\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^{-1}\\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T\\]\nが成り立つ。\n証明\n\\[\\mathbf M=\\begin{pmatrix} \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf f(\\mathbf x,\\mathbf y)^T] & \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\\\ \\mathbb E[\\mathbf f(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]^T & \\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T] \\end{pmatrix}\\]\nとすると、 \\(\\mathbf M\\succeq 0\\) であり、よって \\(\\mathbf M/\\mathbb E[\\mathbf g(\\mathbf x,\\mathbf y)\\mathbf g(\\mathbf x,\\mathbf y)^T]\\succeq 0\\) である。\n\n\n\n\\(\\mathbf w\\) を未知変数、 \\(y\\) を観測変数とする。 Fisher 情報行列を\n\\[\n\\begin{split}\nI(\\mathbf w) &=-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] \\\\\n&= -\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&\\in\\mathbb R^{n\\times n}\n\\end{split}\n\\]\nとする。各要素は\n\\[\nI_{ij}=-\\mathbb E_{y\\mid\\mathbf w}\\left[\\frac{\\partial^2}{\\partial w_i\\partial w_j}\\ln p(y\\mid\\mathbf w)\\right]\n\\]\nとなる。\n\n\n\n\\[\n\\begin{split}\nI(\\mathbf w) &=-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] \\\\\n&= -\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&= -\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\left[\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]\\right)p(y\\mid\\mathbf w)dy \\\\\n&= -\\int\\left(-\\left[\\frac{1}{p(y\\mid\\mathbf w)}\\right]^2\\left[\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]\\left[\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right]^T+\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial^2}{\\partial\\mathbf w^2}p(y\\mid\\mathbf w)\\right)p(y\\mid\\mathbf w)dy \\\\\n&= \\int\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial \\mathbf w}p(y\\mid\\mathbf w)\\right)\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial \\mathbf w}p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy-\\int\\frac{\\partial^2}{\\partial\\mathbf w^2}p(y\\mid\\mathbf w)dy \\\\\n&= \\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy-\\underbrace{\\frac{\\partial^2}{\\partial\\mathbf w^2}\\int p(y\\mid\\mathbf w)dy}_\\mathbf O \\\\\n&= \\mathbb E_{y\\mid\\mathbf w}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]\n\\end{split}\n\\]\nであるから、Fisher 情報行列は\n\\[\nI(\\mathbf w) =-\\mathbb E_{y\\mid \\mathbf w}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y\\mid\\mathbf w)\\right] = \\mathbb E_{y\\mid\\mathbf w}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]\n\\]\nと表せる。\n\n\n\n定理\n\\(I(\\mathbf w)\\succ 0\\) のとき、\n\\[\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right]\\succeq I^{-1}(\\mathbf w)\\]\nが成り立つ。ただし、 \\(\\mathbf f(y)\\) は不偏推定値とする。つまり、次式が成り立つとする。\n\\[\\mathbb E_{y\\mid\\mathbf w}[\\mathbf f(y)]=\\mathbf w\\]\n証明\nSchur 補行列の正定値性より、\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right] \\\\\n&\\succeq \\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]I^{-1}(\\mathbf w)\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right]^T\n\\end{split}\n\\]\nここで、\n\\[\n\\begin{split}\n\\mathbb E_{y\\mid\\mathbf w}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(y\\mid\\mathbf w)\\right)^T\\right] &= \\int\\left(\\mathbf w-\\mathbf f(y)\\right)\\left(\\frac{1}{p(y\\mid\\mathbf w)}\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right)^Tp(y\\mid\\mathbf w)dy \\\\\n&= \\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(y\\mid\\mathbf w)\\right)^Tdy \\\\\n&= \\mathbf w\\left( \\frac{\\partial}{\\partial \\mathbf w} \\int p(y\\mid\\mathbf w) dy \\right)^T-\\frac{\\partial}{\\partial \\mathbf w^T}\\int \\mathbf f(y) p(y\\mid\\mathbf w)dy \\\\\n&= \\underbrace{\\mathbf w\\left(\\frac{\\partial}{\\partial \\mathbf w} 1\\right)^T}_\\mathbf O-\\frac{\\partial}{\\partial\\mathbf w^T}\\mathbf w \\\\\n&= -\\mathbf I\n\\end{split}\n\\]\nが成り立つ。 \\(\\mathbf I\\) は単位行列を表す。\n\n\n\n\\(\\mathbf w\\) を未知変数、 \\(y\\) を観測変数とする。 ベイズ情報行列を\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w, y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w, y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w, y)\\right)p(\\mathbf w, y)dyd\\mathbf w \\\\\n&\\in\\mathbb R^{n\\times n}\n\\end{split}\n\\]\nとする。各要素は\n\\[\nJ_{ij}=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial w_i\\partial w_j}\\ln p(\\mathbf w,y)\\right]\n\\]\nとなる。\n\n\n\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= -\\int\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\left[\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= -\\int\\int\\left(-\\left[\\frac{1}{p(\\mathbf w,y)}\\right]^2\\left[\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]\\left[\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right]^T+\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial^2}{\\partial\\mathbf w^2}p(\\mathbf w,y)\\right)p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial \\mathbf w}p(\\mathbf w,y)\\right)\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial \\mathbf w}p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy-\\int\\int\\frac{\\partial^2}{\\partial\\mathbf w^2}p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy-\\underbrace{\\frac{\\partial^2}{\\partial\\mathbf w^2}\\int\\int p(\\mathbf w,y)d\\mathbf wdy}_\\mathbf O \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]\n\\end{split}\n\\]\nであり、\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= -\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w\\mid y)\\right)p(\\mathbf w,y)d\\mathbf wdy -\\underbrace{\\int\\int\\left(\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(y)\\right)p(\\mathbf w,y)d\\mathbf wdy}_\\mathbf O \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)^T\\right]\n\\end{split}\n\\]\nであるから、ベイズ情報行列は\n\\[\n\\begin{split}\nJ &=-\\mathbb E_{\\mathbf w,y}\\left[\\frac{\\partial^2}{\\partial \\mathbf w^2}\\ln p(\\mathbf w,y)\\right] \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right] \\\\\n&= \\mathbb E_{\\mathbf w,y}\\left[\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}\\ln p(\\mathbf w\\mid y)\\right)^T\\right]\n\\end{split}\n\\]\nと表せる。\n\n\n\n定理\n\\(J\\succ 0\\) のとき、\n\\[\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right]\\succeq J^{-1}\\]\nが成り立つ。ただし、次式が成り立つとする。\n\\[\\lim_{\\mathbf w_i\\to\\pm\\infty}\\mathbb E_{y\\mid\\mathbf w}[\\mathbf f(y)-\\mathbf w]p(\\mathbf w)=\\lim_{\\mathbf w_i\\to\\pm\\infty}\\int (\\mathbf f(y)-\\mathbf w)p(\\mathbf w,y)dy=\\mathbf 0,\\ i=1,\\ldots,n\\]\n証明\nSchur 補行列の正定値性より、\n\\[\n\\begin{split}\n&\\phantom{=}\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))(\\mathbf w-\\mathbf f(y))^T\\right] \\\\\n&\\succeq \\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]J^{-1}\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right]^T\n\\end{split}\n\\]\nここで、\n\\[\n\\begin{split}\n\\mathbb E_{\\mathbf w,y}\\left[(\\mathbf w-\\mathbf f(y))\\left(\\frac{\\partial}{\\partial \\mathbf w}\\ln p(\\mathbf w,y)\\right)^T\\right] &= \\int\\int\\left(\\mathbf w-\\mathbf f(y)\\right)\\left(\\frac{1}{p(\\mathbf w,y)}\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Tp(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Td\\mathbf wdy\n\\end{split}\n\\]\nが成り立つ。\\(ij\\) 要素に対して置換積分すると、\n\\[\n\\begin{split}\n& \\left\\{\\int\\int \\left(\\mathbf w - \\mathbf f(y)\\right)\\left(\\frac{\\partial}{\\partial\\mathbf w}p(\\mathbf w,y)\\right)^Td\\mathbf wdy\\right\\}_{ij} \\\\\n&= \\int\\int(w_i-f_i(y))\\left(\\frac{\\partial}{\\partial w_j}p(\\mathbf w,y)\\right)d\\mathbf wdy \\\\\n&= \\int\\int\\left[(w_i-f_i(y))p(\\mathbf w,y)\\right]_{w_j=-\\infty}^{w_j=\\infty}d\\mathbf w_kdy-\\int\\int\\frac{\\partial}{\\partial w_j}(w_i-f_i(y))p(\\mathbf w,y)d\\mathbf wdy \\\\\n&= \\int\\left[\\lim_{w_j\\to\\infty}\\int(w_i-f_i(y))p(\\mathbf w,y)dy-\\lim_{w_j\\to-\\infty}\\int(w_i-f_i(y))p(\\mathbf w,y)dy\\right]d\\mathbf w_k - I_{ij} \\\\\n&= -I_{ij}\n\\end{split}\n\\]\nとなる。\\(\\mathbf w_k\\) は \\(k\\neq j\\) となる全ての \\(k\\) を添字とする \\(w\\) を表す。 \\(I_{ij}\\) とは単位行列 \\(\\mathbf I\\) の \\(ij\\) 要素を表す。\n\\[\\frac{d}{dx}\\sigma(x)=\\sigma(x)\\{1-\\sigma(x)\\}\\]\n\nsource\n\n\n\n\n dxlosi (x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nx\nndarray\n\\(x\\)\n\n\nReturns\nndarray\n\\(\\lambda(x)\\)\n\n\n\n\\[\\sigma_t=\\sigma(\\hat{\\mathbf w}_{t/t-1}^T\\mathbf x_t)\\] \\[\\mathbf P_{t/t}=\\mathbf P_{t/t-1}-\\frac{\\sigma_t(1-\\sigma_t)}{1+\\sigma_t(1-\\sigma_t)\\mathbf x_t^T\\mathbf P_{t/t-1}\\mathbf x_t}(\\mathbf P_{t/t-1}\\mathbf x_t)(\\mathbf P_{t/t-1}\\mathbf x_t)^T\\]\n\nsource\n\n\n\n\n Ptt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\n\n\\[\\hat{\\mathbf w}_{t/t}=\\hat{\\mathbf w}_{t/t-1}+\\frac{1}{1+\\sigma_t(1-\\sigma_t)\\mathbf x_t^T\\mathbf P_{t/t-1}\\mathbf x_t}\\mathbf P_{t/t-1}\\mathbf x_t(y_t-\\sigma_t)\\]\n\nsource\n\n\n\n\n wtt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\ny\nndarray\n\\(y_t\\)\n\n\n\n\\[N,T,\\{ \\mathbf x_t \\}_{t=0,\\ldots,T-1}, \\{ y_t \\}_{t=0,\\ldots,T-1}, \\boldsymbol\\Gamma, \\hat{\\mathbf w}_{0/-1}, \\mathbf P_{0/-1} \\\\\n\\to\\{\\hat{\\mathbf w}_{t/t}\\}_{t=0,\\ldots,T-1},\\{\\mathbf P_{t/t}\\}_{t=0,\\ldots,T-1}\\]\n\nsource\n\n\n\n\n EKF (N:int, T:int,\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      G:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      P0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])",
    "crumbs": [
      "EKF",
      "Extended Kalman Filter"
    ]
  },
  {
    "objectID": "VA/va.html",
    "href": "VA/va.html",
    "title": "Variational Approximation",
    "section": "",
    "text": "\\[\\mathbf P_{t/t}^{-1}=\\mathbf P_{t/t-1}^{-1}+2\\lambda(\\xi_t)\\mathbf x_t\\mathbf x_t^T\\]\n\nsource\n\nPtt\n\n Ptt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      xi:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\nxi\nndarray\n\\(\\xi_t\\)\n\n\n\n\\[\\hat{\\mathbf w}_{t/t}=\\mathbf P_{t/t}\\left(\\mathbf P_{t/t-1}^{-1}\\hat{\\mathbf w}_{t/t-1}+(y_t-1/2)\\mathbf x_t\\right)\\]\n\nsource\n\n\nwtt\n\n wtt (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      Ptt_:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n      x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nPtt_\nndarray\n\\(\\mathbf P_{t/t}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\ny\nndarray\n\\(y_t\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\n\n\\[\\xi_t=\\sqrt{\\mathbf x_t^T\\left(\\mathbf P_{t/t-1}+\\hat{\\mathbf w}_{t/t-1}\\hat{\\mathbf w}_{t/t-1}^T\\right)\\mathbf x_t}\\]\n\nsource\n\n\nxipre\n\n xipre (Ptm:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        w:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])\n\n\n\n\n\nType\nDetails\n\n\n\n\nPtm\nndarray\n\\(\\mathbf P_{t/t-1}\\)\n\n\nw\nndarray\n\\(\\hat{\\mathbf w}_{t/t-1}\\)\n\n\nx\nndarray\n\\(\\mathbf x_t\\)\n\n\n\n\\[N,T,\\{ \\mathbf x_t \\}_{t=0,\\ldots,T-1}, \\{ y_t \\}_{t=0,\\ldots,T-1}, \\boldsymbol\\Gamma, \\hat{\\mathbf w}_{0/-1}, \\mathbf P_{0/-1} \\\\\n\\to\\{\\hat{\\mathbf w}_{t/t}\\}_{t=0,\\ldots,T-1},\\{\\mathbf P_{t/t}\\}_{t=0,\\ldots,T-1},\\{\\xi_t\\}_{t=0,\\ldots,T-1}\\]\n\nsource\n\n\nVApre\n\n VApre (N:int, T:int,\n        x:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        y:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        G:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        w0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]],\n        P0:numpy.ndarray[typing.Any,numpy.dtype[numpy.float64]])",
    "crumbs": [
      "VA",
      "Variational Approximation"
    ]
  },
  {
    "objectID": "Exp/exp.html",
    "href": "Exp/exp.html",
    "title": "Experimentation",
    "section": "",
    "text": "simple.losi(np.array([1,2], dtype=np.float64))\n\narray([0.73105858, 0.88079708])",
    "crumbs": [
      "Exp",
      "Experimentation"
    ]
  },
  {
    "objectID": "common.html#状態推定問題",
    "href": "common.html#状態推定問題",
    "title": "共通概念・表記",
    "section": "状態推定問題",
    "text": "状態推定問題\n観測データ \\(\\mathbf Y_t\\) に基づいて、ベイズリスク\n\\[\nJ=\\mathbb E[\\|\\mathbf w_{t+m}-\\hat{\\mathbf w}_{t+m/t}\\|^2],\\ m=0,1\n\\]\nを最小にする最適推定値 \\(\\hat{\\mathbf w}_{t+m/t}\\) は\n\\[\n\\hat{\\mathbf w}_{t+m/t}=\\mathbb E_{\\mathbf w_{t+m}\\mid\\mathbf Y_t}[\\mathbf w_{t+m}]\n\\]\nで与えられる。次式で説明される。\n\\[\\frac{\\partial}{\\partial \\hat{\\mathbf w}_{t+m/t}}J=\\int 2(\\mathbf w_{t+m}-\\hat{\\mathbf w}_{t+m/t})p(\\mathbf w\\mid y)d\\mathbf w=0\\]",
    "crumbs": [
      "共通概念・表記"
    ]
  }
]