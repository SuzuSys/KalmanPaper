# 実験ノート


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## 12/02.1

### 概要

新たな評価基準を設けた。それによる考察を兼ねて、実験結果を整理する。

### 実験

次元数 2 、*w*<sub>0</sub> = (0, 0)<sup>*T*</sup>
で、次の４象限に分けて実験結果をまとめた。

<table>
<thead>
<tr>
<th><span class="math inline"><strong>Γ</strong></span></th>
<th><span class="math inline"><strong>Σ</strong></span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span
class="math inline">2<sup>−4</sup><strong>I</strong></span></td>
<td><span
class="math inline">2<sup>−2</sup><strong>I</strong></span></td>
</tr>
<tr>
<td><span
class="math inline">2<sup>−4</sup><strong>I</strong></span></td>
<td><span
class="math inline">2<sup>4</sup><strong>I</strong></span></td>
</tr>
<tr>
<td><span
class="math inline">2<sup>−12</sup><strong>I</strong></span></td>
<td><span
class="math inline">2<sup>−2</sup><strong>I</strong></span></td>
</tr>
<tr>
<td><span
class="math inline">2<sup>−12</sup><strong>I</strong></span></td>
<td><span
class="math inline">2<sup>4</sup><strong>I</strong></span></td>
</tr>
</tbody>
</table>

### 結果

<figure>
<img src="AnalysisNoteImage/120101.drawio.png" title="サンプル"
alt="エビフライトライアングル" />
<figcaption aria-hidden="true">エビフライトライアングル</figcaption>
</figure>

- **w**<sub>*t*</sub> の遷移が大きい（ **Γ**
  が大きい）ほど、(EKFよりも)変分近似が優れる
- **x** の分散に関しては、単純に優劣の評価ができない。

<figure>
<img src="AnalysisNoteImage/120102.drawio.png" title="aaa" alt="aaa" />
<figcaption aria-hidden="true">aaa</figcaption>
</figure>

- **x**<sub>*t*</sub> の分散や **w**<sub>*t*</sub>
  の分散は、単純にスケールされている点に注意が必要

## 12/10.1

### 概要

推定誤差共分散行列は、両者に明確な大小がある。

**P**<sub>*t*/*t*</sub><sup>−1</sup> = **P**<sub>*t*/*t* − 1</sub><sup>−1</sup> + *σ*<sub>*t*</sub>(1 − *σ*<sub>*t*</sub>)**x**<sub>*t*</sub>**x**<sub>*t*</sub><sup>*T*</sup>

**P**<sub>*t*/*t*</sub><sup>−1</sup> = **P**<sub>*t*/*t* − 1</sub><sup>−1</sup> + 2*λ*(*ξ*<sub>*t*</sub>)**x**<sub>*t*</sub>**x**<sub>*t*</sub><sup>*T*</sup>

- 青: *σ*(*x*){1 − *σ*(*x*)}
- 緑:
  $2\lambda(x)=\displaystyle\frac{1}{x}\left(\sigma(x)-\frac{1}{2}\right)$

<figure>
<img src="AnalysisNoteImage/121001.png" alt="aaa" />
<figcaption aria-hidden="true">aaa</figcaption>
</figure>

### 実験

$$\overline{\mathbf P}=\frac{1}{N\_{\text{seed}}T}\sum\_{s,t}\text{seed} (s) \text{における}\mathbf P\_{t/t}$$
$$\text{frob\\error}=\\\overline{\mathbf P}-\mathbf\Gamma\\\_F$$
$$\text{relative\\error}=\frac{\text{frob\\error}}{\\\Gamma\\\_F}$$
**Γ** = 2<sup>*p*</sup>**I**

<figure>
<img src="AnalysisNoteImage/121601.png" alt="aaa" />
<figcaption aria-hidden="true">aaa</figcaption>
</figure>

### 備考

*p*(**w**<sub>*t*</sub> ∣ **w**<sub>*t* − 1</sub>) = 𝒩(**w**<sub>*t*</sub> ∣ **w**<sub>*t* − 1</sub>, **Γ**)
$$p(\mathbf w_t\mid\mathbf Y_t) = \mathcal N(\mathbf w_t\mid\hat{\mathbf w}\_{t/t},\mathbf P\_{t/t})$$

**Y**<sub>*t*</sub> には **w**<sub>*t* − 1</sub>
の情報が入っているので、次の２つの式はほとんど同じ

*p*(**w**<sub>*t*</sub>) = ∫*p*(**w**<sub>*t*</sub> ∣ **Y**<sub>*t*</sub>)*p*(**Y**<sub>*t*</sub>)*d***Y**<sub>*t*</sub>

*p*(**w**<sub>*t*</sub> ∣ **w**<sub>*t* − 1</sub>) = ∫*p*(**w**<sub>*t*</sub> ∣ **w**<sub>*t* − 1</sub>, **Y**<sub>*t*</sub>)*p*(**Y**<sub>*t*</sub>)*d***Y**<sub>*t*</sub>

実験では、**P**<sub>*t*/*t*</sub> に対して期待値をとっている。

## 12/16.1

### 概要

表に対して、比較するグラフを作成。

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th><span class="math inline"> </span></th>
<th>Frobenius error</th>
<th>Relative error</th>
</tr>
</thead>
<tbody>
<tr>
<td>normal plot</td>
<td><img src="AnalysisNoteImage/121601_frob_error%20(1).png"
alt="aaa" /></td>
<td><img src="AnalysisNoteImage/121601_frob_error%20(3).png"
alt="aaa" /></td>
</tr>
<tr>
<td>log plot</td>
<td><img src="AnalysisNoteImage/121601_frob_error%20(2).png"
alt="aaa" /></td>
<td><img src="AnalysisNoteImage/121601_frob_error%20(4).png"
alt="aaa" /></td>
</tr>
</tbody>
</table>

### 考察

**Γ**
の大きさに合わせて、フロベニウス誤差が線形に増加しているのが正常であると考えられる。

<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr>
<th><span class="math inline"> </span></th>
<th><span class="math inline"><em>p</em> = −4</span></th>
<th><span class="math inline"><em>p</em> = −12</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span
class="math display"><em>ŵ</em><sub><em>t</em></sub><sup>1</sup> − <em>w</em><sub><em>t</em></sub><sup>1</sup></span></td>
<td><img src="AnalysisNoteImage/121602_p_4.png" alt="aaa" /></td>
<td><img src="AnalysisNoteImage/121602_p_12.png" alt="aaa" /></td>
</tr>
</tbody>
</table>

## 12/23.1

### 概要

データの生成過程を変更して実験を行ったが、結果があまり変わらなかった。

<figure>
<img src="AnalysisNoteImage/122301.png" alt="aaa" />
<figcaption aria-hidden="true">aaa</figcaption>
</figure>

## 1/6.1

### 概要

濾波推定値 **w**<sub>*t*/*t*</sub> を EKF によって推論し、誤差共分散行列
**P**<sub>*t*/*t*</sub> を変分近似で推論する手法を試した。

通常の EKF と比較して、性能が向上すれば、EKF
の誤差共分散行列の推定が不適切であることを部分的に示すことができる。

$$\hat{\mathbf w}\_{t/t}=\hat{\mathbf w}\_{t/t-1}+\frac{1}{1+\sigma_t(1-\sigma_t)\mathbf x_t^T\mathbf P\_{t/t-1}\mathbf x_t}\mathbf P\_{t/t-1}\mathbf x_t(y_t-\sigma_t)$$

$$\mathbf P\_{t/t}=\mathbf P\_{t/t-1}-\frac{2\lambda(\xi_t)}{1+2\lambda(\xi_t)\mathbf x_t^T\mathbf P\_{t/t-1}\mathbf x_t}\left(\mathbf P\_{t/t-1}\mathbf x_t\right)\left(\mathbf P\_{t/t-1}\mathbf x_t\right)^T $$

$$\xi_t=\sqrt{\mathbf x_t^T\left(\mathbf P\_{t/t-1}+\hat{\mathbf w}\_{t/t-1}\hat{\mathbf w}\_{t/t-1}^T\right)\mathbf x_t}$$

### 結果

wEXP_PVA がここで定義した手法

- この手法はどのパラメータにおいても、変分近似に劣る
- EKF
  のばらつきが大きいパラメータにおいては、この手法はばらつきがそれほど大きくない
- EKF のばらつきは、誤差共分散行列によって引き起こされていると考えられる

<table>
<thead>
<tr>
<th><span class="math inline"> </span></th>
<th><span class="math display"><em>p</em> = −4</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="math display"><em>q</em> = −2</span></td>
<td><img src="AnalysisNoteImage/010601p_4q_2.png" alt="aaa" /></td>
</tr>
<tr>
<td><span class="math display"><em>q</em> = 2</span></td>
<td><img src="AnalysisNoteImage/010601p_4q2.png" alt="aaa" /></td>
</tr>
<tr>
<td><span class="math display"><em>q</em> = 4</span></td>
<td><img src="AnalysisNoteImage/010601p_4q4.png" alt="aaa" /></td>
</tr>
</tbody>
</table>
