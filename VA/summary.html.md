# å¤‰åˆ†è¿‘ä¼¼ã®æ¦‚è¦


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## EM ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### æ¦‚è¦

EM
ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ç›®çš„ã¯ã€æ½œåœ¨å¤‰æ•°ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ã«ã¤ã„ã¦æœ€å°¤è§£ã‚’è¦‹å‡ºã™ã“ã¨ã§ã‚ã‚‹ã€‚

å…¨ã¦ã®è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿ã®é›†åˆã‚’ **X** ã€å…¨ã¦ã®æ½œåœ¨å¤‰æ•°ã®é›†åˆã‚’ **Z**
ã€å…¨ã¦ã®ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®é›†åˆã‚’ **Î¸** ã§è¡¨ã™ã€‚

æœ€å°¤è§£ $\hat{\boldsymbol\theta}$ ã¯æ¬¡å¼ã§è¡¨ã•ã‚Œã‚‹ã€‚

$$\hat{\boldsymbol\theta}=\arg\max\_{\boldsymbol\theta}p(\mathbf X\mid\boldsymbol\theta)=\arg\max\_{\boldsymbol\theta}\sum\_{\mathbf Z}p(\mathbf X,\mathbf Z\mid\boldsymbol\theta)$$

å¯¾æ•°å°¤åº¦é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹ã€‚

lnâ€†*p*(**X**â€…âˆ£â€…**Î¸**)â€„=â€„lnâ€†{âˆ‘<sub>**Z**</sub>*p*(**X**,â€†**Z**â€…âˆ£â€…**Î¸**)}

ã“ã®ã‚ˆã†ã«ã€æ½œåœ¨å¤‰æ•°ã«é–¢ã™ã‚‹ç·å’ŒãŒå¯¾æ•°ã®ä¸­ã«ã‚ã‚Šã€åŒæ™‚åˆ†å¸ƒ
*p*(**X**,â€†**Z**â€…âˆ£â€…**Î¸**) ãŒæŒ‡æ•°å‹åˆ†å¸ƒæ—ã«å±ã™ã‚‹å ´åˆã§ã‚‚ã€å‘¨è¾ºåˆ†å¸ƒ
*p*(**X**â€…âˆ£â€…**Î¸**) ã¯æŒ‡æ•°å‹åˆ†å¸ƒæ—ã«ãªã‚‰ãªã„ã€‚

{**X**,â€†**Z**} ã¨ã„ã†çµ„ã‚’**å®Œå…¨ãƒ‡ãƒ¼ã‚¿é›†åˆ**ã¨å‘¼ã³ã€å®Ÿéš›ã®è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿
**X** ã¯**ä¸å®Œå…¨**ã¨å‘¼ã¶ã“ã¨ã«ã™ã‚‹ã€‚å®Œå…¨ãƒ‡ãƒ¼ã‚¿é›†åˆã«é–¢ã™ã‚‹å¯¾æ•°å°¤åº¦é–¢æ•°
lnâ€†*p*(**X**,â€†**Z**â€…âˆ£â€…**Î¸**) ã®æœ€å¤§åŒ–ã¯ç°¡å˜ã«ã§ãã‚‹ã¨ä»®å®šã™ã‚‹ã€‚

å®Ÿéš›ã«ã¯ã€å®Œå…¨ãƒ‡ãƒ¼ã‚¿é›†åˆ {**X**,â€†**Z**} ã¯ä¸ãˆã‚‰ã‚Œãšã€ä¸å®Œå…¨ãƒ‡ãƒ¼ã‚¿ **X**
ã ã‘ãŒä¸ãˆã‚‰ã‚Œã‚‹ã€‚æ½œåœ¨å¤‰æ•° **Z** ã«ã¤ã„ã¦ã®çŸ¥è­˜ã¯äº‹å¾Œç¢ºç‡åˆ†å¸ƒ
*p*(**Z**â€…âˆ£â€…**X**,â€†**Î¸**) ã«ã‚ˆã‚‹ã‚‚ã®ã ã‘ã§ã‚ã‚‹ã€‚

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><span class="math inline">â€Š</span></th>
<th>æ•°å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›®çš„ ï¼ˆæŒ‡æ•°å‹åˆ†å¸ƒæ—ã§ã¯ãªã„ï¼‰</td>
<td><span
class="math inline">argâ€†max<sub><strong>Î¸</strong></sub><em>p</em>(<strong>X</strong>â€…âˆ£â€…<strong>Î¸</strong>)</span></td>
</tr>
<tr>
<td>ç°¡å˜ã€€ï¼ˆæŒ‡æ•°å‹åˆ†å¸ƒæ—ã§ã‚ã‚‹ï¼‰</td>
<td><span
class="math inline">argâ€†max<sub><strong>Î¸</strong></sub><em>p</em>(<strong>X</strong>,â€†<strong>Z</strong>â€…âˆ£â€…<strong>Î¸</strong>)</span></td>
</tr>
<tr>
<td>æ—¢çŸ¥</td>
<td><span
class="math inline"><em>p</em>(<strong>Z</strong>â€…âˆ£â€…<strong>X</strong>,â€†<strong>Î¸</strong>),Â <em>p</em>(<strong>X</strong>,â€†<strong>Z</strong>â€…âˆ£â€…<strong>Î¸</strong>)</span></td>
</tr>
</tbody>
</table>

EMã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã¯ã€æ¬¡ã®ï¼’ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¸ã‚€ã€‚

**Eã‚¹ãƒ†ãƒƒãƒ—**

$$
\begin{split}
\mathcal Q(\boldsymbol\theta,\boldsymbol\theta^{\text{old}}) &=\mathbb E\_{\mathbf Z\mid\mathbf X,\boldsymbol\theta^{\text{old}}}\left\[\ln p(\mathbf X,\mathbf Z\mid\boldsymbol\theta)\right\] \\
&= \sum\_{\mathbf Z} p(\mathbf Z\mid\mathbf X,\boldsymbol\theta^{\text{old}})\ln p(\mathbf X,\mathbf Z\mid\boldsymbol\theta)
\end{split}
$$

**Mã‚¹ãƒ†ãƒƒãƒ—**

**Î¸**<sup>new</sup>â€„=â€„argâ€†max<sub>**Î¸**</sub>ğ’¬(**Î¸**,â€†**Î¸**<sup>old</sup>)

### *p*(**Î¸**) ãŒæ—¢çŸ¥ã®å ´åˆ

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®äº‹å‰åˆ†å¸ƒ *p*(**Î¸**) ãŒæ—¢çŸ¥ã®å ´åˆã€MAP è§£ã‚’è¨ˆç®—ã§ãã‚‹ã€‚

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr>
<th><span class="math inline">â€Š</span></th>
<th>æ•°å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›®çš„ ï¼ˆæŒ‡æ•°å‹åˆ†å¸ƒæ—ã§ã¯ãªã„ï¼‰</td>
<td><span
class="math inline">argâ€†max<sub><strong>Î¸</strong></sub><em>p</em>(<strong>Î¸</strong>â€…âˆ£â€…<strong>X</strong>)</span></td>
</tr>
<tr>
<td>ç°¡å˜ã€€ï¼ˆæŒ‡æ•°å‹åˆ†å¸ƒæ—ã§ã‚ã‚‹ï¼‰</td>
<td><span
class="math inline">argâ€†max<sub><strong>Î¸</strong></sub><em>p</em>(<strong>X</strong>,â€†<strong>Z</strong>â€…âˆ£â€…<strong>Î¸</strong>)</span></td>
</tr>
<tr>
<td>æ—¢çŸ¥</td>
<td><span
class="math inline"><em>p</em>(<strong>Z</strong>â€…âˆ£â€…<strong>X</strong>,â€†<strong>Î¸</strong>),Â <em>p</em>(<strong>X</strong>,â€†<strong>Z</strong>â€…âˆ£â€…<strong>Î¸</strong>),Â <em>p</em>(<strong>Î¸</strong>)</span></td>
</tr>
</tbody>
</table>

$$
\begin{split}
\boldsymbol\theta^{\text{new}} &=\arg\max\_{\boldsymbol\theta}\left(\mathcal Q(\boldsymbol\theta,\boldsymbol\theta^{\text{old}})+\ln p(\boldsymbol\theta)\right) \\
&= \arg\max\_{\boldsymbol\theta}\mathbb E\_{\mathbf Z\mid\mathbf X,\boldsymbol\theta^{\text{old}}}\left\[\ln p(\mathbf X,\mathbf Z,\boldsymbol\theta)\right\] \\
&= \arg\max\_{\boldsymbol\theta}\mathbb E\_{\mathbf Z\mid\mathbf X,\boldsymbol\theta^{\text{old}}}\left\[\ln p(\boldsymbol\theta\mid\mathbf X,\mathbf Z)\right\]
\end{split}
$$

## ä¸€èˆ¬ã®EMã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

æ½œåœ¨å¤‰æ•°ã«ã¤ã„ã¦ã®åˆ†å¸ƒ *q*(**Z**) ã‚’å°å…¥ã™ã‚‹ã€‚ *q*(**Z**)
ã®è¨­å®šã®ä»•æ–¹ã«é–¢ã‚ã‚‰ãšã€æ¬¡ã®åˆ†è§£ãŒæˆã‚Šç«‹ã¤ã€‚

lnâ€†*p*(**X**â€…âˆ£â€…**Î¸**)â€„=â€„â„’(*q*,â€†**Î¸**)â€…+â€…KL(*q*âˆ¥*p*)

ãŸã ã—ã€

$$\mathcal L(q,\boldsymbol\theta)=\sum\_{\mathbf Z}q(\mathbf Z)\ln\left\\ \frac{p(\mathbf X,\mathbf Z\mid\boldsymbol\theta)}{q(\mathbf Z)} \right\\$$
$$\mathrm{KL}(q\\p)=-\sum\_{\mathbf Z}q(\mathbf Z)\ln\left\\ \frac{p(\mathbf Z\mid\mathbf X,\boldsymbol\theta)}{q(\mathbf Z)} \right\\$$

$$
\begin{split}
\because\ln p(\mathbf X\mid\boldsymbol\theta) &=\mathcal L(q,\boldsymbol\theta)+\mathrm{KL}(q\\p) \\
&= \sum\_{\mathbf Z}q(\mathbf Z)\left(\ln\left\\ \frac{p(\mathbf X,\mathbf Z\mid\boldsymbol\theta)}{q(\mathbf Z)} \right\\-\ln\left\\ \frac{p(\mathbf Z\mid\mathbf X,\boldsymbol\theta)}{q(\mathbf Z)} \right\\\right) \\
&= \sum\_{\mathbf Z}q(\mathbf Z)\left(\ln\left\\ \frac{p(\mathbf Z\mid\mathbf X,\boldsymbol\theta)p(\mathbf X\mid\boldsymbol\theta)}{q(\mathbf Z)} \right\\-\ln\left\\ \frac{p(\mathbf Z\mid\mathbf X,\boldsymbol\theta)}{q(\mathbf Z)} \right\\\right) \\
&= \sum\_{\mathbf Z}q(\mathbf Z)\ln p(\mathbf X\mid\boldsymbol\theta)
\end{split}
$$

â„’(*q*,â€†**Î¸**) ã¯åˆ†å¸ƒ *q*(**Z**) ã®æ±é–¢æ•°ã§ã‚ã‚Šã€ã‹ã¤ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ **Î¸**
ã®é–¢æ•°ã§ã‚ã‚‹ã€‚

KL(*q*âˆ¥*p*)â€„â‰¥â€„0 ã€ç­‰å·ã¯ *q*(**Z**)â€„=â€„*p*(**Z**â€…âˆ£â€…**X**,â€†**Î¸**)
ã®ã¨ãã®ã¿æˆç«‹ã™ã‚‹ã€‚ã‚ˆã£ã¦ (1) ã‚ˆã‚Šã€
â„’(*q*,â€†**Î¸**)â€„â‰¤â€„lnâ€†*p*(**X**â€…âˆ£â€…**Î¸**)
ãŒæˆã‚Šç«‹ã¤ã€‚ã¤ã¾ã‚Šã€ â„’(*q*,â€†**Î¸**) ã¯ *q* ã¨ **Î¸** ã«ã‚ˆã‚‰ãšå¸¸ã«
lnâ€†*p*(**X**â€…âˆ£â€…**Î¸**) ã®ä¸‹ç•Œã‚’ãªã™ã€‚

## å±€æ‰€çš„å¤‰åˆ†æ¨è«–æ³•

æ¬¡ã®ç©åˆ†ã‚’è¨ˆç®—ã—ãŸã„ã¨ã™ã‚‹ã€‚

*I*â€„=â€„âˆ«*Ïƒ*(*a*)*p*(*a*)*d**a*

ç©åˆ†ã‚’ãã®ã¾ã¾æ±‚ã‚ã‚‹ã®ã¯ä¸å¯èƒ½ãªãŸã‚ã€å¤‰åˆ†ä¸‹ç•Œ *Ïƒ*(*a*)â€„â‰¥â€„*f*(*a*,â€†*Î¾*)
ã®å½¢ã§ç”¨ã„ã‚‹ã€‚ã“ã“ã§ã€ *Î¾* ã¯å¤‰åˆ†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚

*I*â€„â‰¥â€„âˆ«*f*(*a*,â€†*Î¾*)*p*(*a*)*d**a*â€„=â€„â„’(*Î¾*)

â„’(*Î¾*) ã¯å˜ã« *Î¾* ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã™ã‚‹é–¢æ•°ã§ã‚ã‚‹ã€‚ â„’(*Î¾*) ã‚’æœ€å¤§åŒ–ã™ã‚‹å€¤
*Î¾*<sup>\*</sup> ã‚’æ±‚ã‚ã‚‹ã€‚

ãŸã ã—ã€æœ€é©åŒ–ã—ãŸã“ã®ä¸‹ç•Œã¯ä¸€èˆ¬ã«æ­£ç¢ºã§ã¯ãªã„ã€‚ãªãœãªã‚‰
*Ïƒ*(*a*)â€„â‰¥â€„*f*(*a*,â€†*Î¾*) ã¯å³å¯†ã«æœ€é©åŒ–ã§ãã‚‹ãŒã€é¸ã‚“ã  *Î¾* ã¯ *a*
ã®å€¤ã«ä¾å­˜ã—ã¦ãŠã‚Šã€ä¸‹ç•ŒãŒæ­£ã—ã„ã®ã¯ã‚ã‚‹ *a*
ã®å€¤ã«ã¤ã„ã¦ã ã‘ã ã‹ã‚‰ã§ã‚ã‚‹ã€‚

â„’(*Î¾*) ã¯å…¨ã¦ã® *a* ã®å€¤ã«ã¤ã„ã¦ç©åˆ†ã—ã¦å¾—ã‚‰ã‚Œã‚‹ã‹ã‚‰ã€ *Î¾*<sup>\*</sup>
ã®å€¤ã¯åˆ†å¸ƒ *p*(*a*) ã«ã‚ˆã‚‹é‡ã¿ã§å¹³å‡åŒ–ã—ã¦ã—ã¾ã£ãŸå€¤ã‚’è¡¨ã—ã¦ã„ã‚‹ã€‚
